/*
 * Copyright (c) 2023. Author: Ruslan Bikchentaev. All rights reserved.
 * Use of this source code is governed by a BSD-style
 * license that can be found in the LICENSE file.
 * Перший приватний програміст.
 */

// Code generated by qtc from "html.qtpl". DO NOT EDIT.
// See https://github.com/valyala/quicktemplate for details.

//line html.qtpl:1
package forms

//line html.qtpl:1
import (
	"strconv"
	"strings"
)

//line html.qtpl:8
import (
	qtio422016 "io"

	qt422016 "github.com/valyala/quicktemplate"
)

//line html.qtpl:8
var (
	_ = qtio422016.Copy
	_ = qt422016.AcquireByteBuffer
)

//line html.qtpl:8
func (f *FormField) StreamFormHTML(qw422016 *qt422016.Writer) {
//line html.qtpl:10
	idShake := strings.ReplaceAll(f.Title, " ", "_")
	defBlocks := make([]string, 0)
	var data map[string]any
	if h, ok := f.HideBlock.(map[string]any); ok {
		for _, p := range h["defaultBlocks"].([]any) {
			defBlocks = append(defBlocks, p.(string))
		}
		data = h["data"].(map[string]any)
	}

//line html.qtpl:19
	qw422016.N().S(`<form id="`)
//line html.qtpl:20
	qw422016.E().S(idShake)
//line html.qtpl:20
	qw422016.N().S(`_form" name="`)
//line html.qtpl:20
	qw422016.E().S(f.Title)
//line html.qtpl:20
	qw422016.N().S(`" role='form' class="form-horizontal" target="content"action="`)
//line html.qtpl:21
	qw422016.E().S(f.Action)
//line html.qtpl:21
	qw422016.N().S(`" method="`)
//line html.qtpl:21
	qw422016.N().S(f.Method)
//line html.qtpl:21
	qw422016.N().S(`" enctype="multipart/form-data"oninput="d = document.querySelector('button.hidden', this); if (d) {d.className = 'main-btn'};"onchange="d = document.querySelector('button.hidden', this); if (d) {d.className = 'main-btn'};"onsubmit="return saveForm(this, afterSaveAnyForm);" novalidate caption="`)
//line html.qtpl:24
	qw422016.E().S(f.Title)
//line html.qtpl:24
	qw422016.N().S(`" ><figcaption>`)
//line html.qtpl:26
	qw422016.N().S(f.Description)
//line html.qtpl:26
	qw422016.N().S(`</figcaption>`)
//line html.qtpl:27
	for _, block := range f.Blocks {
//line html.qtpl:29
		isHide := (len(defBlocks) > 0)
		for _, id := range defBlocks {
			if id == strconv.Itoa(block.Id) {
				isHide = false
				break
			}
		}

//line html.qtpl:36
		qw422016.N().S(`<figure id = "block`)
//line html.qtpl:37
		qw422016.N().D(block.Id)
//line html.qtpl:37
		qw422016.N().S(`"`)
//line html.qtpl:37
		if isHide {
//line html.qtpl:37
			qw422016.N().S(`style="display:none"`)
//line html.qtpl:37
		}
//line html.qtpl:37
		qw422016.N().S(`>`)
//line html.qtpl:38
		if block.Title > "" {
//line html.qtpl:38
			qw422016.N().S(`<figcaption>`)
//line html.qtpl:38
			qw422016.E().S(block.Title)
//line html.qtpl:38
			qw422016.N().S(`</figcaption>`)
//line html.qtpl:38
		}
//line html.qtpl:39
		if block.Description > "" {
//line html.qtpl:39
			qw422016.N().S(`<p>`)
//line html.qtpl:39
			qw422016.E().S(block.Description)
//line html.qtpl:39
			qw422016.N().S(`</p>`)
//line html.qtpl:39
		}
//line html.qtpl:40
		for i, col := range block.Columns {
//line html.qtpl:42
			if val := col.GetValues(); col.IsReadOnly && (len(val) == 0 || val[0] == nil) {
				continue
			}

//line html.qtpl:45
			qw422016.N().S(`<div id="divField`)
//line html.qtpl:46
			qw422016.N().D(i)
//line html.qtpl:46
			qw422016.N().S(`" class="input-wrap"`)
//line html.qtpl:46
			if col.IsHidden {
//line html.qtpl:46
				qw422016.N().S(`style="display:none"`)
//line html.qtpl:46
			}
//line html.qtpl:46
			qw422016.N().S(`><label class="input-label">`)
//line html.qtpl:48
			col.StreamRenderInputs(qw422016, data)
//line html.qtpl:48
			qw422016.N().S(`<h6 class="errorLabel">`)
//line html.qtpl:49
			qw422016.N().S(col.patternDesc)
//line html.qtpl:49
			qw422016.N().S(`</h6></label></div>`)
//line html.qtpl:52
		}
//line html.qtpl:53
		if block.Multiple {
//line html.qtpl:53
			qw422016.N().S(`<button class="main-btn" type="button"onclick="this.parentNode.insertBefore(this.previousElementSibling.cloneNode(true), this); return false;">+</button>`)
//line html.qtpl:56
		}
//line html.qtpl:57
		if len(block.Buttons) > 0 {
//line html.qtpl:57
			qw422016.N().S(`<div class="form-actions">`)
//line html.qtpl:58
			for _, btn := range block.Buttons {
//line html.qtpl:58
				qw422016.N().S(`<button class="`)
//line html.qtpl:59
				if btn.Position {
//line html.qtpl:59
					qw422016.N().S(`hidden`)
//line html.qtpl:59
				} else {
//line html.qtpl:59
					qw422016.N().S(`button`)
//line html.qtpl:59
				}
//line html.qtpl:59
				qw422016.N().S(`" type="`)
//line html.qtpl:59
				qw422016.N().S(btn.Type)
//line html.qtpl:59
				qw422016.N().S(`"`)
//line html.qtpl:60
				if btn.OnClick > "" {
//line html.qtpl:60
					qw422016.N().S(`onClick="`)
//line html.qtpl:60
					qw422016.E().S(btn.OnClick)
//line html.qtpl:60
					qw422016.N().S(`"`)
//line html.qtpl:60
				}
//line html.qtpl:60
				qw422016.N().S(`>`)
//line html.qtpl:61
				qw422016.E().S(btn.Title)
//line html.qtpl:61
				qw422016.N().S(`</button>`)
//line html.qtpl:63
			}
//line html.qtpl:63
			qw422016.N().S(`</div>`)
//line html.qtpl:65
		}
//line html.qtpl:65
		qw422016.N().S(`</figure>`)
//line html.qtpl:67
	}
//line html.qtpl:67
	qw422016.N().S(`<output></output><progress value='0' max='100' hidden > </progress></form>`)
//line html.qtpl:71
	qw422016.N().S(` `)
//line html.qtpl:72
	qw422016.N().S(`
<script>
function inputSearchKeyUp(thisElem, event){

        var x = event.which || event.keyCode;
        var elem = $(thisElem)
        var thisClass = 'select.suggestions-select-show.'+thisElem.attributes.data.value
        var thisClassH = 'select.suggestions-select-hide.'+thisElem.attributes.data.value

        if (x == 40) {
            elem.unbind("blur");
            $(thisClass).focus();
            $(thisClass + ' option:first').selected();

           return;
        }

         elem.on("blur", function(){

               if (event.relatedTarget && event.relatedTarget.className == "suggestions-select-show") {
                         return;
               }

                 console.log(event);
                 $(thisClass).removeClass('suggestions-select-show').addClass('suggestions-select-hide');
             })

         if (elem.val().length < 2) {
            return true;
         }

         $.ajax({
             url: thisElem.src,
             data: {
                     "lang": lang,
                     "value": thisElem.value,
                     "count": 10,
                     "html": true
             },
           beforeSend: function (xhr) {
               xhr.setRequestHeader('Authorization', 'Bearer ' + token);
           },
           success: function (data, status) {
             $(thisClassH).html(data).removeClass('suggestions-select-hide').addClass('suggestions-select-show')
             .on('keyup', function(event) {
                         var x = event.which || event.keyCode;
                         if (x == 32) {
                                 thisElem.value = $(thisClass + ' option:selected').text();
                                 $(thisClass).removeClass('suggestions-select-show').addClass('suggestions-select-hide');

                                 return false;
                          }
                   });
             $(thisClass + ' option').on('mouseup', function(e) {
                thisElem.value = $(this).text();
                 $(thisClass).removeClass('suggestions-select-show').addClass('suggestions-select-hide');

                return true;
             });

           },
           error: function (xhr, status, error) {
               alert( "Code : " + xhr.status + " error :"+ error);
               console.log(error);
           }
          });
}

function ShowBlocks(thisElem){
    d=$(thisElem).data('show-blocks');
    $(thisElem).parents('form').children('figure').hide();
    d[$('option:selected', thisElem).val()].every(function (e) {$('#block'+ e).show(); return true;})
}

function Prev(elem, id) {
	block = $(elem).parents('figure');
	block.hide();
	$('#block'+id).show();
}
function Next(elem, id) {
	block = $(elem).parents('figure');
    if (!validateFields(block[0]))
        return false;

	block.hide();
	newBlock = $('#block'+id).show()[0];
	newBlock.scrollIntoView();
	fields = $('input, select', newBlock)
	if (fields.length > 0) {
		fields[0].focus();
	}
	return false;
}

$(function()   {
	textInputs = $('textarea');
	if (textInputs.length > 0) {
		if (tinymce === undefined) {
			LoadJScript("https://cdn.tiny.cloud/1/2os6bponsl87x9zsso916jquzsi298ckurhmnf7fp9scvpgt/tinymce/6/tinymce.min.js", false, true)
		}

		textInputs.focus(
			function (event) {
				let name = event.target.name;
			    tinymce.init({
                  target: event.target,
                  menubar: false,
                  plugins: 'anchor autolink charmap codesample emoticons image link lists media searchreplace table visualblocks wordcount    ',
                  toolbar: 'undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table mergetags | addcomment showcomments | spellcheckdialog a11ycheck | align lineheight | numlist bullist indent outdent  | removeformat',
                  mergetags_list: [
                    { value: "name", title: name },
                    { value: 'placeholder', title: name },
                  ],
                  setup: (editor) => {
                      editor.on('input', (e) => {
                       console.log(e);
                       $('#`)
//line html.qtpl:188
	qw422016.E().S(idShake)
//line html.qtpl:188
	qw422016.N().S(`_form button.hidden').removeClass('hidden').addClass('main-btn');
                      });

                      editor.on('focusout', (e) => {
                       $('textarea[name="' + name +'"]').text( editor.getContent({ format: 'text' }) );
                      });
                    }
                });
        });
	}
});
</script>
`)
//line html.qtpl:200
}

//line html.qtpl:200
func (f *FormField) WriteFormHTML(qq422016 qtio422016.Writer) {
//line html.qtpl:200
	qw422016 := qt422016.AcquireWriter(qq422016)
//line html.qtpl:200
	f.StreamFormHTML(qw422016)
//line html.qtpl:200
	qt422016.ReleaseWriter(qw422016)
//line html.qtpl:200
}

//line html.qtpl:200
func (f *FormField) FormHTML() string {
//line html.qtpl:200
	qb422016 := qt422016.AcquireByteBuffer()
//line html.qtpl:200
	f.WriteFormHTML(qb422016)
//line html.qtpl:200
	qs422016 := string(qb422016.B)
//line html.qtpl:200
	qt422016.ReleaseByteBuffer(qb422016)
//line html.qtpl:200
	return qs422016
//line html.qtpl:200
}
